(this.webpackJsonpview=this.webpackJsonpview||[]).push([[0],{100:function(e,a,t){e.exports=t.p+"static/media/camera.26347224.svg"},101:function(e,a,t){e.exports=t.p+"static/media/bag.efe56d36.svg"},102:function(e,a,t){e.exports=t.p+"static/media/clock.d1fd750c.svg"},103:function(e,a,t){e.exports=t.p+"static/media/swap.61dcf460.svg"},107:function(e,a,t){e.exports=t.p+"static/media/logo.0e197889.png"},111:function(e,a,t){e.exports=t(192)},116:function(e,a,t){},14:function(e,a,t){e.exports={container:"Conversations_container__qWCSX",chatsList:"Conversations_chatsList__5ZFOR",searchContainer:"Conversations_searchContainer__2t-Jn",pin:"Conversations_pin__IN16Z",true:"Conversations_true__3zKza",chat:"Conversations_chat__tpWya",info:"Conversations_info__3x34d",message:"Conversations_message__2nOMD",unread:"Conversations_unread__2jppe",letter:"Conversations_letter__2BMf-",lowBattery:"Conversations_lowBattery__3I5Zn",header:"Conversations_header__2TEBo",bg:"Conversations_bg__Fy8_9"}},163:function(e,a){},181:function(e,a,t){e.exports=t.p+"static/media/mic.3f6068f3.svg"},192:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(46),o=t.n(r),s=(t(116),t(24)),l=t(20),i=t(37),u=t(3),m=t.n(u),d=t(8),p=t(2),g=t(15),f=t.n(g),h=t(17),v=t.n(h),E=(t(134),t(83)),b=t.n(E),w=t(110),C="/api/",y={params:{access_token:localStorage.access_token}},S=t(48),_=t.n(S),O=t(5),k=t.n(O),N=t(109),j=t(84),I=t(14),x=t.n(I),A=t(85),M=t.n(A),B=function(e){var a=e.handleNewContact,t=e.handleQuery,r=Object(n.useState)(""),o=Object(p.a)(r,2),s=o[0],l=o[1],i=Object(n.useState)(!1),u=Object(p.a)(i,2),m=u[0],d=u[1];return c.a.createElement("div",{className:x.a.searchContainer},c.a.createElement("input",{placeholder:"Pesquisar...",type:"text",value:s,onChange:function(e){var a=e.target.value;l(a),t(a,m)}}),c.a.createElement("button",{onClick:function(){d(!m),t(s,!m)}},c.a.createElement("div",{className:k()(x.a.pin,x.a[m])})),c.a.createElement("button",{onClick:a},c.a.createElement("img",{src:M.a,alt:"New contact"})))},L=t(16),q=t.n(L),D=t(86),T=t.n(D);function F(e){var a,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=/\*(.+?)\*/g,c=/_(.+?)_/g,r=/\n/g,o="<br />";return"string"===typeof e?a=e:Array.isArray(e)&&(a=e.join(" ")),t||(o="&nbsp;"),"string"!==typeof a?a:a.replace(c,"<i>$1</i>").replace(r,o).replace(n,"<b>$1</b>")}var V=function(e){var a=e.slice(2,e.indexOf("@")),t=a.slice(0,2),n=a.slice(-4),c=a.slice(2,-4);return 4===c.length&&(c="9"+c),"(".concat(t,") ").concat(c,"-").concat(n)},P=t(49),R=t(50),U=t.n(R),G=function(e){var a=e.text,t=e.enter,n=Object(P.renderToString)(c.a.createElement(U.a,{text:a}));return c.a.createElement("span",{dangerouslySetInnerHTML:{__html:F(n,t)}})},W=function(e){var a=e.text,t=e.enter,n=Object(P.renderToString)(c.a.createElement(U.a,{text:a}));return c.a.createElement("p",{dangerouslySetInnerHTML:{__html:F(n,t)}})},J={sameDay:"HH:mm",nextDay:"[Tomorrow]",lastDay:"[Ontem]",lastWeek:"dddd",sameElse:"DD/MM/YYYY"},H=function(e){var a,t=e.data,r=e.handleClick,o=e.style,s=Object(n.useState)(""),l=Object(p.a)(s,2),i=l[0],u=l[1],m=Object(n.useState)(),d=Object(p.a)(m,2),g=d[0],f=d[1],h="initial";window.agents&&(a=window.agents,v.a.forEach(a,(function(e,a){a===t.agentId&&(h=e.color)})));return Object(n.useEffect)((function(){!function(){var e=t.messages[0];e?"chat"===e.type?u(e.body):"ptt"===e.type?u("\xc1udio"):"sale"===e.type?u("Venda"):"image"===e.type?u("\ud83d\udcf7 Foto"):u(e.type):u("~Sem mensagem"),e&&f(e.mine)}()})),c.a.createElement("div",{className:x.a.chat,style:o,onClick:r},c.a.createElement("img",{src:t.profilePic,alt:"Chat"}),c.a.createElement("div",null,c.a.createElement("div",{className:x.a.info},c.a.createElement("b",null,t.displayName),c.a.createElement("p",null,q()(t.lastMessageAt).calendar(J))),c.a.createElement("div",{className:x.a.message},g&&c.a.createElement("img",{src:T.a,alt:"Enviado"}),i&&c.a.createElement(W,{text:i,enter:!1}),t.agentId&&c.a.createElement("span",{className:x.a.letter,style:{backgroundColor:h}},a[t.agentId].firstLetter),t.unread>0&&c.a.createElement("span",{className:x.a.unread},t.unread))))},Q=c.a.memo((function(){return c.a.createElement("div",{className:k()(x.a.chat,x.a.lowBattery)},"A bateria est\xe1 acabando. Carregue o celular principal.")})),K=t(87),z=t.n(K),Y=t(88),X=t.n(Y),Z=t(89),$=t.n(Z),ee=c.a.memo((function(e){var a,t=e.logout,n=e.handleSettings,r=(a=localStorage.salesAgentProfile?JSON.parse(localStorage.salesAgentProfile):JSON.parse(localStorage.agents)[localStorage.userId])&&a.fullName||"";return c.a.createElement("div",{className:k()(x.a.header)},c.a.createElement("img",{className:x.a.bg,src:z.a,alt:"Zoppy"}),c.a.createElement("p",null,r),c.a.createElement("button",{onClick:n},c.a.createElement("img",{src:$.a,alt:"change settings"})),c.a.createElement("button",{onClick:function(){return t()}},c.a.createElement("img",{src:X.a,alt:"change user"})))})),ae=t(51),te=t.n(ae),ne=function(){return c.a.createElement("div",{className:te.a.container},c.a.createElement("div",{className:te.a.loader},c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null),c.a.createElement("div",null)))},ce=function(e){var a=e.data,t=e.index,n=e.style;return c.a.createElement(H,{style:n,data:a.dataToShow[t],handleClick:function(){return a.handleSelectChat(a.dataToShow[t].chatId)}})},re=function(e){var a=e.data,t=e.handleQuery,r=e.handleSelectChat,o=e.handleNewContactModal,s=e.handleSettingsModal,l=e.showing,i=e.logout,u=e.lowBattery,m=Object(n.useState)(a),d=Object(p.a)(m,2),g=d[0],f=d[1];return Object(n.useEffect)((function(){f(a.filter((function(e){return e.filtered})))}),[a]),c.a.createElement("div",{className:k()(x.a.container,"mobile-fullwidth",l)},localStorage.agents&&localStorage.userId&&c.a.createElement(ee,{logout:i,handleSettings:s}),c.a.createElement(B,{handleNewContact:o,handleQuery:t}),u&&c.a.createElement(Q,null),c.a.createElement("div",{className:x.a.chatsList},a.length?c.a.createElement(j.a,null,(function(e){var a=e.height,t=e.width;return c.a.createElement(N.a,{height:a,itemData:{dataToShow:g,handleSelectChat:r},itemCount:g.length,itemSize:81,width:t},ce)})):c.a.createElement(ne,null)))},oe=t(90),se=t.n(oe),le=t(91),ie=t.n(le),ue=t(92),me=t.n(ue),de=t(93),pe=t.n(de),ge=t(94),fe=t.n(ge),he=t(95),ve=t.n(he),Ee=t(96),be=t.n(Ee),we=t(22),Ce=t.n(we),ye=t(97),Se=t.n(ye),_e=function(e){var a=e.data,t=e.handleBack,n=e.handleToggleDetails;return c.a.createElement("div",{className:Ce.a.header,onClick:n},c.a.createElement("button",{onClickCapture:t,className:k()(Ce.a.arrow,"mobile-only")},c.a.createElement("img",{src:Se.a,alt:"back"})),c.a.createElement("img",{className:Ce.a.profilePic,src:a.profilePic,alt:"Foto"}),c.a.createElement("div",{className:Ce.a.name},c.a.createElement("div",{className:Ce.a.name},a.displayName)))},Oe=t(21),ke=t.n(Oe),Ne=(t(179),t(108)),je=t(98),Ie=t.n(je),xe=t(99),Ae=t.n(xe),Me=t(100),Be=t.n(Me),Le=(t(181),t(101)),qe=t.n(Le);function De(){return(De=Object(d.a)(m.a.mark((function e(){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return a=e.sent,e.abrupt("return",new MediaRecorder(a));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te,Fe=function(){var e=Object(n.useState)(""),a=Object(p.a)(e,2),t=a[0],c=a[1],r=Object(n.useState)(!1),o=Object(p.a)(r,2),s=o[0],l=o[1],i=Object(n.useState)(null),u=Object(p.a)(i,2),m=u[0],d=u[1];Object(n.useEffect)((function(){if(null!==m){s?m.start():m.stop();var e=function(e){c(URL.createObjectURL(e.data))};return m.addEventListener("dataavailable",e),function(){return m.removeEventListener("dataavailable",e)}}s&&function(){return De.apply(this,arguments)}().then(d,console.error)}),[m,s]);return[t,s,function(){l(!0)},function(){l(!1)}]},Ve=function(e){var a=e.message,t=e.handleChangeMessage,r=e.send,o=e.handleModal,s=Object(n.useState)(1),l=Object(p.a)(s,2),i=l[0],u=l[1],m=Object(n.useState)(),d=Object(p.a)(m,2),g=d[0],f=d[1],h=Object(n.useState)(!1),v=Object(p.a)(h,2),E=v[0],b=v[1],w=Object(n.useState)(!1),C=Object(p.a)(w,2),y=C[0],S=C[1],_=Object(n.useState)(0),O=Object(p.a)(_,2),N=(O[0],O[1],Object(n.useRef)()),j=Fe(),I=Object(p.a)(j,4);I[0],I[1],I[2],I[3];Object(n.useEffect)((function(){localStorage.settings&&JSON.parse(localStorage.settings).salesOptions?S(!0):S(!1)}),[localStorage.settings]);var x,A;x=N,A=function(){f(!1)},Object(n.useEffect)((function(){function e(e){x.current&&!x.current.contains(e.target)&&A(e)}return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[x]);var M=function(){r(a),t(""),u(1)};return c.a.createElement(c.a.Fragment,null,g&&c.a.createElement("div",{className:ke.a.emojiContainer,ref:N},c.a.createElement(Ne.a,{showPreview:!1,showSkinTones:!1,title:"Emoji",set:"apple",onSelect:function(e){t(a+e.native)}})),c.a.createElement("div",{className:k()(ke.a.input,ke.a[E])},c.a.createElement("button",{className:ke.a.hide,onClick:function(){return o("picUpload")}},c.a.createElement("img",{className:ke.a.camera,src:Be.a,alt:"upload"})),y&&c.a.createElement("button",{className:ke.a.hide,onClick:function(){return o("sale")}},c.a.createElement("img",{src:qe.a,alt:"Nova venda"})),c.a.createElement("button",{onClick:function(){f(!g)}},c.a.createElement("img",{src:Ae.a,alt:"Emoji"})),c.a.createElement("textarea",{type:"text",rows:i,value:a,onKeyDown:function(e){13!==e.keyCode||e.shiftKey||(e.preventDefault(),a&&M())},onChange:function(e){e.persist();var a=e.target.rows;e.target.rows=1;var n=~~(e.target.scrollHeight/24);n===a&&(e.target.rows=n),n>=3&&(e.target.rows=3,e.target.scrollTop=e.target.scrollHeight),t(e.target.value),u(n<3?n:3)},onFocus:function(){return b(!0)},onBlur:function(){a||b(!1)},placeholder:"Digite uma mensagem"}),c.a.createElement("button",{onClick:function(){return M()}},c.a.createElement("img",{src:Ie.a,alt:"Enviar"}))))},Pe=t(6),Re=t.n(Pe),Ue=t(102),Ge=t.n(Ue),We=function(e){var a=e.message,t=e.isGroup,n=window.agents,r="WhatsApp";return a.agentId&&(r=n[a.agentId].fullName),c.a.createElement("div",null,c.a.createElement("div",{className:Re.a.message},t&&!a.mine&&c.a.createElement("p",null,a.sender),a.agentId&&c.a.createElement("p",null,r),c.a.createElement("div",{className:Re.a.msg},c.a.createElement(G,{text:a.body}),c.a.createElement("span",{className:Re.a.buffer}))),c.a.createElement("div",{className:Re.a.time},c.a.createElement("p",null,q()(a.timestamp).format("HH:mm")),a.sending&&c.a.createElement("img",{src:Ge.a,alt:"Sending"})))},Je=function(e){var a=e.message,t=e.isGroup,n=e.showMedia;return c.a.createElement("div",null,c.a.createElement("div",{className:Re.a.message},t&&!a.mine&&c.a.createElement("p",null,a.sender),c.a.createElement("div",{className:Re.a.image,onClick:function(){return n("image",a.messageId)},style:{backgroundImage:"url(data:image/jpg;base64,".concat(a.body,")")}},c.a.createElement("div",{className:Re.a.highResImg,style:{backgroundImage:"url(".concat(C,"chats/download/").concat(a.messageId,"?access_token=").concat(localStorage.access_token,")")}})),a.caption&&c.a.createElement("div",{className:Re.a.msg},c.a.createElement(G,{text:a.caption}),c.a.createElement("span",{className:Re.a.buffer}))),c.a.createElement("div",{className:Re.a.time},c.a.createElement("p",null,q()(a.timestamp).format("HH:mm"))))},He=function(e){var a=e.message;return c.a.createElement("div",{className:Re.a.sale},c.a.createElement("p",null,a.body))},Qe=function(e){var a=e.message,t=e.isGroup,r=Object(n.useState)(null),o=Object(p.a)(r,2),s=o[0],l=o[1],i=Object(n.useState)(!1),u=Object(p.a)(i,2),g=u[0],f=u[1],h=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f(!g);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)((function(){try{l(new Audio("".concat(C,"chats/download/").concat(a.messageId,"?access_token=").concat(localStorage.access_token)))}catch(e){console.log(e)}}),[a.messageId]),Object(n.useEffect)((function(){if(s)try{for(var e=document.getElementsByTagName("audio"),a=0;a<e.length;a++)e[a].pause();return g?s.play():s.pause(),s.addEventListener("ended",(function(){return f(!1)})),function(){s.removeEventListener("ended",(function(){return f(!1)}))}}catch(t){alert("erro ao reproduzir!"),console.log(t)}}),[g,s]),c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement("div",{className:Re.a.message},t&&!a.mine&&c.a.createElement("p",null,a.sender),c.a.createElement("div",{className:Re.a.msg},c.a.createElement("div",{onClick:h,className:Re.a.audio},c.a.createElement("div",{className:k()(g?Re.a.paused:null,Re.a.audioController)})))),c.a.createElement("div",{className:Re.a.time},c.a.createElement("p",null,q()(a.timestamp).format("HH:mm")))))},Ke=function(e){var a=e.message,t=e.isGroup;return c.a.createElement("div",{className:Re.a.noBg},c.a.createElement("div",{className:Re.a.message},t&&!a.mine&&c.a.createElement("p",null,a.sender),c.a.createElement("div",{className:Re.a.sticker},c.a.createElement("img",{src:"".concat(C,"chats/download/").concat(a.messageId,"?access_token=").concat(localStorage.access_token),alt:"Adesivo"}))),c.a.createElement("div",{className:Re.a.time},c.a.createElement("p",null,q()(a.timestamp).format("HH:mm"))))},ze=function(e){var a,t=e.message,n=e.isGroup,r=e.showMedia,o=t.mine?Re.a.right:Re.a.left,s=1;return t.sending&&(s=.8),"chat"===t.type?a=We:"image"===t.type?a=Je:"sticker"===t.type?a=Ke:"ptt"===t.type&&(a=Qe),"sale"===t.type?c.a.createElement("div",{className:Re.a.container},c.a.createElement(He,{message:t})):a?c.a.createElement("div",{className:k()(Re.a.container,o),style:{opacity:s}},c.a.createElement(a,{showMedia:r,message:t,isGroup:n})):null},Ye={sameDay:"[Hoje]",lastDay:"[Ontem]",lastWeek:"dddd",sameElse:"DD/MM/YYYY"},Xe=function(e){var a=e.day;return c.a.createElement("div",{className:k()(Re.a.container,Re.a.center)},c.a.createElement("div",{className:Re.a.day},q()(a).calendar(Ye)))},Ze=function(e){var a=e.messages,t=e.more,r=e.handleModal,o=e.loading,s=e.chatId,i=e.handleLoadMore,u=e.send,m=e.showMedia,d=Object(n.useState)(""),g=Object(p.a)(d,2),f=g[0],h=g[1],v=s.includes("-"),E=Object(n.useRef)(),b=new Date(a[0].timestamp);return Object(n.useEffect)((function(){E.current.scrollIntoView()}),[]),c.a.createElement("div",{className:ke.a.chat},c.a.createElement("div",{className:ke.a.scroll},c.a.createElement("div",{className:ke.a.container},c.a.createElement("div",{ref:E}),c.a.createElement(c.a.Fragment,null,a.length&&a.map((function(e,t){var r=Object(l.a)({},e),o=b,i=r.timestamp;return r.mine&&!r.agentId&&(r.agentId="wpp"),b=i,"none"===r||r.chatId!==s?void 0:t===a.length-1?c.a.createElement(n.Fragment,{key:r.messageId},c.a.createElement(ze,{showMedia:m,key:r.messageId,message:r,isGroup:v}),c.a.createElement(Xe,{day:o})):q()(o).isSame(b,"day")?c.a.createElement(ze,{showMedia:m,key:r.messageId,message:r,isGroup:v}):c.a.createElement(n.Fragment,{key:r.messageId},c.a.createElement(Xe,{day:o}),c.a.createElement(ze,{showMedia:m,message:r,isGroup:v}))})),o&&c.a.createElement(ne,null),t&&c.a.createElement("div",{onClick:i,className:ke.a.loadMore},"Carregar mais")))),c.a.createElement(Ve,{handleModal:r,message:f,handleChangeMessage:h,send:u}))},$e=function(e){var a=e.showing;return c.a.createElement("div",{className:k()(Ce.a.centerContainer,Ce.a.noChat,"mobile-fillWidth",a)},c.a.createElement("h1",null,"Selecione uma conversa no chat ao lado"))},ea=t(23),aa=t.n(ea),ta=t(103),na=t.n(ta),ca=function(e){var a=e.data,t=e.handleClose,r=e.handleChangeName,o=e.show,s=e.handlePin,l=Object(n.useState)(a.displayName),i=Object(p.a)(l,2),u=i[0],g=i[1],f=Object(n.useState)(a.displayName),h=Object(p.a)(f,2),v=h[0],E=h[1],b=Object(n.useState)(!1),w=Object(p.a)(b,2),C=w[0],y=w[1],S=Object(n.useState)(""),_=Object(p.a)(S,2),O=_[0],N=_[1];Object(n.useEffect)((function(){g(a.displayName),E(a.displayName)}),[a.displayName]),Object(n.useEffect)((function(){if(a.agentId){var e=JSON.parse(localStorage.agents)[a.agentId];N(e.fullName)}else N()}),[a]);var j=function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:13===a.keyCode&&(r(u),a.target.blur(),E(u),g(u));case 1:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),I=function(e){27===e.keyCode&&t()};Object(n.useEffect)((function(){t()}),[a.chatId]),Object(n.useEffect)((function(){return document.addEventListener("keydown",I,!1),function(){document.removeEventListener("keydown",I,!1)}}),[]);return c.a.createElement("div",{className:k()(aa.a.container,aa.a[o])},c.a.createElement("div",{className:aa.a.close,onClick:t},"\xd7"),c.a.createElement("img",{className:aa.a.profilePic,src:a.profilePic,alt:""}),c.a.createElement("div",{className:aa.a.dataContainer},c.a.createElement("input",{className:aa.a.nameInput,type:"text",value:u,onKeyDown:j,onFocus:function(){y(!0)},onBlur:function(){g(v),y(!1)},onChange:function(e){return g(e.target.value)}}),C&&c.a.createElement("div",{className:aa.a.hintBubble},"Aperte enter para salvar ou clique fora do campo para cancelar"),c.a.createElement("h3",null,V(a.chatId)),c.a.createElement("div",{className:aa.a.salesAgent},c.a.createElement("h2",null,"Atendente: ",O||"Nenhum"),c.a.createElement("button",{onClick:function(){a.agentId===window.me?s(!0):s(!1)}},c.a.createElement("img",{src:na.a,alt:"Trocar"})))))},ra=function(e){var a=e.chat,t=e.handleChangeName,r=e.handleSend,o=e.handleLoadMore,s=e.handleModal,l=e.showMedia,i=e.showing,u=e.handlePin,m=e.handleBack,d=Object(n.useState)(!1),g=Object(p.a)(d,2),f=g[0],h=g[1];return a?c.a.createElement("div",{className:k()(Ce.a.chatContainer,"mobile-fullwidth",i)},c.a.createElement(_e,{data:a,handleBack:m,handleToggleDetails:function(){return h(!f)}}),c.a.createElement(Ze,{handleModal:s,showMedia:l,handleLoadMore:o,send:r,more:a.more,chatId:a.chatId,handleChangeName:t,messages:a.messages,loading:a.firstClick}),c.a.createElement(ca,{show:f,data:a,handlePin:u,handleChangeName:t,handleClose:function(){return h(!1)}})):c.a.createElement($e,{showing:i})},oa=t(104),sa=t(106),la=(t(191),t(4)),ia=t.n(la),ua=t(107),ma=t.n(ua),da=t(26),pa=t.n(da),ga=JSON.parse(localStorage.settings||1),fa=function(e){var a=e.file,t=e.onClose,r=e.handleSendImage,o=e.handleNewChat,i=e.handleLogin,u=e.handleUpload,m=e.selectUser,d=e.saveSales,g=e.handleChangeSettings,f=Object(n.useState)(""),h=Object(p.a)(f,2),E=h[0],b=h[1],w=Object(n.useState)(""),y=Object(p.a)(w,2),S=y[0],_=y[1],O=Object(n.useState)(""),N=Object(p.a)(O,2),j=N[0],I=N[1],x=Object(n.useState)(!1),A=Object(p.a)(x,2),M=A[0],B=A[1],L=Object(n.useState)(a&&a.settings||ga),q=Object(p.a)(L,2),D=q[0],T=q[1];Object(n.useEffect)((function(){B(!1),b(""),_(""),I(""),a&&a.newNumber?_(a.newNumber):a&&"sale"===a.type&&_("sale")}),[a]);var F,V,P=function(e){e.preventDefault(),B(!0),r(E)},R=function(e){if(e.preventDefault(),S.match(/^\(\d{2}\) \d{5}-\d{4}$/g)){B(!0);var a="55"+S.replace(/\D/g,"")+"@c.us";o(S,a)}else alert("N\xfamero inv\xe1lido")},U=function(e){e.preventDefault(),E&&j?i(E,j):alert("Insira seu usu\xe1rio e senha!")},G=function(){var e=E,a=j,t=S,n=/^[0-9]{1,4}([.,][0-9]{1,2})?$/g;if(e.match(n)&&("sale"!==S||a.match(n))){var c={itemCount:e.replace(",","."),totalValue:a.replace(",","."),type:t};B(!0),d(c)}else alert("Dados inv\xe1lidos. Verifique os n\xfameros")},W=function(e){var a=e.target;console.log(a.name,a.checked);var t=Object(l.a)(Object(l.a)({},D),{},Object(s.a)({},a.name,a.checked));T(t),g(t)};return a&&"image"===a.type?c.a.createElement(oa.a,{imagePadding:32,mainSrc:"".concat(C,"chats/download/").concat(a.id,"?access_token=").concat(localStorage.access_token),onCloseRequest:t}):a&&"qr"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("p",null,a.update),c.a.createElement("h2",null,"Escaneie o QR code pelo WhatsApp"),c.a.createElement("img",{className:ia.a.qr,src:"".concat(C,"chats/qr?access_token=").concat(a.token,"&").concat(a.update),alt:"QR code"}))):a&&"video"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:ia.a.modal},c.a.createElement("video",{src:"".concat(C,"chats/download/").concat(a.id),alt:"V\xeddeo",autoPlay:!0}))):a&&"offline"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("h1",null,"Parece que o celular principal n\xe3o est\xe1 online. Verifique e aguarde."))):a&&"picUpload"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),c.a.createElement("h1",null,"Enviar imagem"),c.a.createElement("label",{htmlFor:"upload-button"},c.a.createElement("div",{className:ia.a.button},"Tirar foto agora")),c.a.createElement("input",{type:"file",accept:"image/*,video/*",capture:!0,id:"upload-button",style:{display:"none"},onChange:u}),c.a.createElement("label",{htmlFor:"upload-button2"},c.a.createElement("div",{className:ia.a.button},"Enviar foto do dispositivo")),c.a.createElement("input",{type:"file",accept:"image/*,video/*",id:"upload-button2",style:{display:"none"},onChange:u}))):a&&"photoUpload"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),"video"===a.format?c.a.createElement("video",{controls:!0,src:URL.createObjectURL(a.data)}):c.a.createElement("img",{src:URL.createObjectURL(a.data),alt:"Imagem"}),c.a.createElement("form",{onSubmit:P},c.a.createElement("input",{type:"text",placeholder:"Mensagem",value:E,onChange:function(e){return b(e.target.value)}}),c.a.createElement("input",{type:"submit",hidden:!0})),c.a.createElement("button",{disabled:M,onClick:P},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"Enviar"))):a&&"newChat"===a.type?(window.agents&&(F=[],v.a.forEach(window.agents,(function(e,a){e.username&&e.isSalesAgent&&F.push([a,e.fullName])}))),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),a.newNumber&&localStorage.salesAgentId&&c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,"Vendedor(a):"),c.a.createElement("form",{action:"null"},c.a.createElement("select",{value:localStorage.salesAgentId,onChange:function(e){return function(e){var a=window.agents[localStorage.salesAgentId];b(e),localStorage.setItem("salesAgentId",e),localStorage.setItem("salesAgentProfile",JSON.stringify(a))}(e.target.value)}},c.a.createElement("option",{value:"",disabled:!0},"Selecione..."),F.map((function(e){return c.a.createElement("option",{value:e[0],key:e[0]},e[1])}))))),c.a.createElement("h2",null,"N\xfamero:"),c.a.createElement("form",{onSubmit:R},c.a.createElement(sa.a,{type:"tel",placeholder:"Celular",format:"(##) #####-####",value:S,onValueChange:function(e){var a=e.formattedValue;return _(a)}}),c.a.createElement("input",{type:"submit",hidden:!0})),c.a.createElement("button",{disabled:M,onClick:R},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"Salvar")))):a&&"selectUser"===a.type?(window.agents&&(V=[],v.a.forEach(window.agents,(function(e,a){e.username&&e.isSalesAgent&&V.push([a,e.fullName])}))),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:ia.a.modalBackground,onClick:onclose}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),c.a.createElement("h2",null,"Vendedor(a)"),c.a.createElement("form",{action:"null"},c.a.createElement("select",{value:E,onChange:function(e){return b(e.target.value)}},c.a.createElement("option",{value:"",disabled:!0},"Selecione..."),V.map((function(e){return c.a.createElement("option",{value:e[0],key:e[0]},e[1])})))),c.a.createElement("button",{disabled:M,onClick:function(){E?m(E):alert("Voc\xea deve selecionar um(a) vendedor(a)")}},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"Entrar"),c.a.createElement("form",{action:""})))):a&&"login"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("img",{className:ia.a.logo,src:ma.a,alt:"Zoppy"}),c.a.createElement("h2",null,"Acesse sua conta"),c.a.createElement("form",{onSubmit:U,noValidate:!0},c.a.createElement("input",{type:"email",placeholder:"usu\xe1rio",value:E,onChange:function(e){return b(e.target.value)}}),c.a.createElement("input",{type:"password",placeholder:"senha",value:j,onChange:function(e){return I(e.target.value)}}),c.a.createElement("input",{type:"submit",hidden:!0})),c.a.createElement("button",{disabled:M,onClick:U},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"Entrar"),c.a.createElement("form",{action:""}))):a&&"settings"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{onClick:t,className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),c.a.createElement("div",{className:ia.a.settings},c.a.createElement("h2",null,"Configura\xe7\xf5es"),c.a.createElement("label",null,"Selecionar vendedor",c.a.createElement("input",{type:"checkbox",name:"manageUsersLocally",checked:D.manageUsersLocally,onChange:W})),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("label",null,"Mostrar op\xe7\xf5es de convers\xe3o",c.a.createElement("input",{type:"checkbox",name:"salesOptions",checked:D.salesOptions,onChange:W}))),c.a.createElement("button",{disabled:M,onClick:t},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"Salvar"))):a&&"sale"===a.type?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:ia.a.modalBackground}),c.a.createElement("div",{className:k()(ia.a.modal,ia.a.opaque)},c.a.createElement("div",{onClick:t,className:ia.a.close},"\xd7"),c.a.createElement("h2",null,"Venda"),c.a.createElement("form",{action:"",onSubmit:G,noValidate:!0},c.a.createElement("input",{type:"number",placeholder:"Num. itens",value:E,onChange:function(e){return b(e.target.value)}}),c.a.createElement("div",{className:ia.a.saleType},c.a.createElement("input",{checked:"sale"===S,onChange:function(){return _("sale")},type:"radio",name:"saleType",id:"sale"}),c.a.createElement("label",{htmlFor:"sale"},"Venda"),c.a.createElement("input",{checked:"bag"===S,onChange:function(){return _("bag")},type:"radio",name:"saleType",id:"bag"}),c.a.createElement("label",{htmlFor:"bag"},"Malinha")),"sale"===S?c.a.createElement("input",{type:"number",placeholder:"Valor total",value:j,onChange:function(e){return I(e.target.value)}}):null,c.a.createElement("input",{type:"submit",hidden:!0})),c.a.createElement("button",{disabled:M,onClick:G},M?c.a.createElement("img",{src:pa.a,alt:"loading spinner"}):"salvar"),c.a.createElement("form",{action:""}))):null},ha=[ie.a,me.a,pe.a,fe.a,ve.a,be.a],va=JSON.parse(localStorage.chats||0),Ea=JSON.parse(localStorage.settings||0)||{manageUsersLocally:!1,salesOptions:!1},ba=function(){var e=Object(w.a)(va||[]),a=Object(p.a)(e,2),t=a[0],r=a[1],o=Object(n.useState)(),u=Object(p.a)(o,2),g=u[0],h=u[1],v=Object(n.useState)(),E=Object(p.a)(v,2),S=E[0],O=E[1],k=Object(n.useState)(new Date),N=Object(p.a)(k,2),j=(N[0],N[1]),I=Object(n.useState)(null),x=Object(p.a)(I,2),A=x[0],M=x[1],B=Object(n.useState)(null),L=Object(p.a)(B,2),q=L[0],D=L[1],T=Object(n.useState)(!1),F=Object(p.a)(T,2),P=F[0],R=F[1],U=Object(n.useState)("conversations"),G=Object(p.a)(U,2),W=G[0],J=G[1],H=Object(n.useState)(!1),Q=Object(p.a)(H,2),K=Q[0],z=Q[1],Y=Object(n.useState)(Ea),X=Object(p.a)(Y,2),Z=X[0],$=X[1],ee=Object(n.useState)(""),ae=Object(p.a)(ee,2),te=ae[0],ne=ae[1],ce=window.innerWidth<=600,oe=new Audio(se.a),le=localStorage.salesAgentId||localStorage.userId;window.me=le;var ie=function(){var e=Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f()("".concat(C,"chats/online"),y);case 3:e.sent.data?(ge(Te),me(),window.socket=Te):(alert("Ops, sua conex\xe3o foi perdida. Continue para sincronizar novamente."),xe(),window.location.reload()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),401===e.t0.response.status&&(alert("Fizemos alguns ajustes por aqui, e voc\xea vai ter que logar novamente"),xe(),window.location.reload());case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),ue=function(e){var a=["TIMEOUT","CONNECTED","PAIRING","OPENING"];a.includes(e.connection)?a.includes(e.connection)&&A&&"offline"===A.type?M(!1):!e.charging&&e.battery<20?z(!0):(e.charging||e.battery>20)&&z(!1):(console.log("OFFLINE",e),M({type:"offline"}))},me=function(){var e=Object(d.a)(m.a.mark((function e(){var a,t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()("".concat(C,"chats/status"),y);case 2:a=e.sent,t=a.data,ue(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=function(e){switch(e){case"conversations":J("conversations"),window.location.hash="";break;case"chat":J("chat"),window.location.hash="chat"}};!function(e,a){var t=Object(n.useRef)();Object(n.useEffect)((function(){t.current=e}),[e]),Object(n.useEffect)((function(){if(null!==a){var e=setInterval((function(){t.current()}),a);return function(){return clearInterval(e)}}}),[a])}((function(){localStorage.connected&&localStorage.access_token}),5e3),Object(n.useEffect)((function(){window.agents=JSON.parse(localStorage.agents||0),window.location.hash="",localStorage.access_token?(ie(),(Te=b()({secure:!0,query:{access_token:localStorage.access_token}})).on("reload",(function(){window.location.reload()})),Te.on("setAgent",(function(e){Be(e)})),Te.on("loadedChats",(function(e){console.log(e),ye(e)})),Te.on("status",(function(e){console.log(e),ue(e)}))):(localStorage.clear(),M({type:"login"})),localStorage.settings?"/"===window.location.pathname&&JSON.parse(localStorage.settings).manageUsersLocally&&M({type:"selectUser"}):localStorage.setItem("settings",JSON.stringify({manageUsersLocally:!1,salesOptions:!1})),window.addEventListener("load",(function(){window.history.pushState({noBackExitsApp:!0},"")})),window.addEventListener("hashchange",pe)}),[]),Object(n.useEffect)((function(){return Te&&(Te.on("newMessage",(function(e){console.log("recieved",e),Ce(e)})),Te.on("sentMessage",(function(e){Se(e)})),Te.on("queryResult",(function(e){qe(e)}))),function(){Te&&(Te.off("newMessage"),Te.off("status"),Te.off("sentMessage"),Te.off("queryResult"))}}),[t]),Object(n.useEffect)((function(){var e=fe(g);S!==e&&O(e),t.length&&!P&&(R(!1),ve()),function(){var e=t.map((function(e){var a=e.displayName,t=e.agentLetter,n=e.chatId,c=e.lastMessageAt,r=e.type,o=e.messages,s=e.profilePic;return{displayName:a,agentLetter:t,chatId:n,lastMessageAt:c,type:r,messages:[o[0]],filtered:!0,firstClick:!1,profilePic:s}}));localStorage.setItem("chats",JSON.stringify(e))}()}),[t]);var pe=function(){var e=window.location.hash;e?"#chat"===e&&J("chat"):J("conversations")},ge=function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Le(),console.log("requesting chats"),a.emit("getChats");case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),fe=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return a.findIndex((function(a){return a.chatId===e}))},he=function(e,a){var n=Object(i.a)(t),c=fe(a),o=t[c];o=Object(l.a)(Object(l.a)({},o),e),n[c]=o,r((function(a){a[c]=Object(l.a)(Object(l.a)({},a[c]),e)}))},ve=function(){var e=window.location.pathname.split("/")[1];if(!(e.length<12)){var a=/^55(\d{2})([89]?)(\d{4})(\d{4})$/g.exec(e);if(a){var t=55+a[1]+a[3]+a[4]+"@c.us",n="(".concat(a[1],") ").concat(a[2]||9).concat(a[3],"-").concat(a[4]);ne(n),fe(t)>=0?Ee(t):M({type:"newChat",newNumber:n}),window.history.pushState({},"Zoppy","/")}}},Ee=function(){var e=Object(d.a)(m.a.mark((function e(a){var n,c,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=fe(a),O(n),c=t[n],D(!1),Oe(null,a),h(c.chatId),de("chat"),!c.firstClick){e.next=24;break}return r={},e.next=11,we(c.chatId);case 11:return o=e.sent,e.prev=12,e.next=15,f()("".concat(C,"chats/").concat(c.chatId,"/profilePic"),y);case 15:r=e.sent,e.next=21;break;case 18:e.prev=18,e.t0=e.catch(12),console.log("fail to load pic");case 21:he({messages:o,profilePic:r.data||c.profilePic,firstClick:!1,unread:0},c.chatId),e.next=25;break;case 24:he({unread:0},c.chatId);case 25:f.a.patch("".concat(C,"chats/").concat(c.chatId,"/seen"),{},y);case 26:case"end":return e.stop()}}),e,null,[[12,18]])})));return function(a){return e.apply(this,arguments)}}(),be=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n,c=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:g,e.prev=1,e.next=4,f.a.patch("".concat(C,"chats/").concat(t,"/name"),{name:a},y);case 4:n=fe(t),r((function(e){return e[n].displayName=a})),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(a){return e.apply(this,arguments)}}(),we=function(){var e=Object(d.a)(m.a.mark((function e(a){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f()("".concat(C,"chats/").concat(a,"/messages"),y);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Ce=function(e){var a,n=e.message,c=fe(n.chatId,t);if(console.log(c),c<0)return e.profilePic=ha[Math.floor(6*Math.random())],e.displayName=V(n.chatId),e.firstClick=!0,e.more=!0,e.unread=1,e.filtered=!0,void r((function(a){return a.unshift(e)}));e.chatId!==g&&"sale"!==n.type&&((!t[c].agentId||t[c].agentId===le||!e.mine)&&n.timestamp>=t[c].lastMessageAt&&(a=!0));var o=t[c].unread;c===S||e.mine||(o?o+=1:o=1),r((function(a){a[c].messages.unshift(e.message),a[c].lastMessageAt=e.message.timestamp||(new Date).toISOString(),a[c].unread=o,a.sort((function(e,a){return e.lastMessageAt<a.lastMessageAt?1:-1}))})),a&&oe.play(),S>=0&&c>S&&O(S+1)},ye=function(e){var a=e.data,t=e.count;console.log(a);var n=a.map((function(e){var a=ha[Math.floor(6*Math.random())];return e.profilePic=e.profilePic||a,e.firstClick=!0,e.filtered=!0,e.more=!0,e.displayName=e.customName||e.name,e.messages.length&&e.messages[0].mine&&(e.unread=0),e}));t?r((function(e){e.push.apply(e,Object(i.a)(n)),e.sort((function(e,a){return e.lastMessageAt<a.lastMessageAt?1:-1}))})):(console.log("STARTING"),r((function(){return n})))},Se=function(e){var a={chatId:e.chatId,message:e},n=fe(a.chatId);if(n<0)return a.profilePic=ha[Math.floor(6*Math.random())],a.displayName=V(a.chatId),a.filtered=!0,r((function(e){return e.unshift(a)})),void(q&&a.chatId===q.chatId&&(Me(!1,q.chatId),a.displayName=q.displayName,D(!1),O(0),Ee(q.chatId)));var c=t[n].messages.findIndex((function(a){return a.sending&&a.body===e.body}));r((function(a){c>=0?a[n].messages[c]=e:a[n].messages.unshift(e),a[n].lastMessageAt=e.timestamp||(new Date).toISOString(),a[n].unread=0,a[n].messages.sort((function(e,a){return e.lastMessageAt<a.lastMessageAt?1:-1})),a.sort((function(e,a){return e.lastMessageAt<a.lastMessageAt?1:-1}))})),c>=0&&O(0)},_e=function(e){var a=fe(e[0].chatId);r((function(t){e.forEach((function(e){t[a].messages.findIndex((function(a){return a.messageId===e.messageId}))<0&&t[a].messages.push(e)}))}))},Oe=function(){var e=Object(d.a)(m.a.mark((function e(a){var n,c,r,o,s,l=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:g,console.log(n),c=fe(n),r=Object(i.a)(t),o=r[c].messages.length,e.next=7,f()("".concat(C,"chats/").concat(n,'/messages?filter={"skip":').concat(o,"}"),y);case 7:(s=e.sent).data.length?_e(s.data):(console.log("no msgs"),he({more:!1},n));case 9:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),ke=function(){var e=Object(d.a)(m.a.mark((function e(a,t){var n,c,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.substring(0,4)+t.substring(5,t.length),!(fe(n)>=0)){e.next=6;break}return Ee(n),M(!1),e.abrupt("return");case 6:if(!(fe(t)>=0)){e.next=11;break}return Ee(t),M(!1),e.abrupt("return");case 11:return e.next=13,f.a.get("".concat(C,"chats/").concat(t,"/check"),y);case 13:if((c=e.sent).data){e.next=19;break}return alert("Esse n\xfamero n\xe3o tem WhatsApp! Tente novamente"),M(!1),M({type:"newChat"}),e.abrupt("return");case 19:r={profilePic:ha[Math.floor(6*Math.random())],chatId:c.data,displayName:a,messages:["none"],type:"chat",timestamp:0},de("chat"),D(r),M(!1);case 23:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n,c,o,s,l,i=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:g,n=i.length>2&&void 0!==i[2]?i[2]:0,j(new Date),q&&(t=q.chatId),Z.manageUsersLocally&&localStorage.salesAgentId&&(c=localStorage.salesAgentId),console.log("sending"),o=(new Date).valueOf(),t===g&&(s={messageId:o,mine:!0,agentId:le,body:a,timestamp:o,sending:!0,type:"chat",sender:"Voc\xea",chatId:t},l=S,Me(),r((function(e){e[l].messages.unshift(s)}))),e.prev=8,e.next=11,f.a.post("".concat(C,"chats/").concat(t,"/send"),{message:a,from:c,customId:o},y);case 11:e.next=21;break;case 13:if(e.prev=13,e.t0=e.catch(8),console.log(e.t0.response),!(n<3)){e.next=20;break}setTimeout(Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne(a,t,n+1);case 2:case"end":return e.stop()}}),e)}))),200),e.next=21;break;case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,null,[[8,13]])})));return function(a){return e.apply(this,arguments)}}(),je=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n,c,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=A.data,(n=new FormData).append("",t),n.append("caption",a),e.next=6,f.a.post("".concat(C,"chats/").concat(g,"/sendMedia"),n,Object(l.a)(Object(l.a)({},y),{},{headers:{accept:"application/json","Content-Type":"application/form-data"}}));case 6:return c=e.sent,o=fe(g),r((function(e){e[o].messages.unshift(c.data)})),M(!1),e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Ie=function(){var e=Object(d.a)(m.a.mark((function e(a,t){var n,c,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="username",a.includes("@")&&(n="email"),e.prev=2,e.next=5,f.a.post("".concat(C,"agents/login"),(c={},Object(s.a)(c,n,a),Object(s.a)(c,"password",t),c));case 5:return r=e.sent,localStorage.setItem("access_token",r.data.id),localStorage.setItem("userId",r.data.userId),e.next=10,f()("".concat(C,"chats/online"),{params:{access_token:r.data.id}});case 10:if(o=e.sent.data,console.log(o),!o){e.next=17;break}localStorage.setItem("connected",!0),window.location.reload(),e.next=21;break;case 17:return e.next=19,f.a.post("".concat(C,"chats/init"),{},{params:{access_token:r.data.id}});case 19:localStorage.removeItem("chats"),setInterval(Object(d.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M({type:"qr",token:r.data.id,update:Math.random()}),e.next=3,f()("".concat(C,"chats/online"),{params:{access_token:r.data.id}});case 3:e.sent.data&&(localStorage.removeItem("chats"),localStorage.setItem("connected",!0),window.location.reload());case 5:case"end":return e.stop()}}),e)}))),2e3);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(2),console.log(e.t0),alert("Email ou senha incorreto");case 27:case"end":return e.stop()}}),e,null,[[2,23]])})));return function(a,t){return e.apply(this,arguments)}}(),xe=function(){localStorage.removeItem("userId"),localStorage.removeItem("access_token"),localStorage.removeItem("connected")},Ae=function(){var e=Object(d.a)(m.a.mark((function e(a){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Z.manageUsersLocally||a){e.next=4;break}M({type:"selectUser"}),e.next=8;break;case 4:return e.next=6,f.a.post("".concat(C,"agents/logout"),{},y);case 6:xe(),M({type:"login"});case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Me=function(){var e=Object(d.a)(m.a.mark((function e(a){var t,n,c=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:g,e.prev=1,e.next=4,f.a.patch("".concat(C,"chats/").concat(t,"/claim"),{remove:!!a,customId:localStorage.salesAgentId},y);case 4:n=e.sent,n.data,e.next=12;break;case 8:throw e.prev=8,e.t0=e.catch(1),console.log(e.t0),new Error("error");case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(a){return e.apply(this,arguments)}}(),Be=function(e){var a=e.agentId,t=e.agentLetter;he({agentId:a,agentLetter:t},e.chatId)},Le=function(){var e=Object(d.a)(m.a.mark((function e(){var a,t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f()("".concat(C,"agents/list"),y);case 3:a=e.sent,(t=a.data).wpp={fullName:"WhatsApp"},window.agents=t,localStorage.setItem("agents",JSON.stringify(t)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),qe=function(e){var a,t=e.res,n=e.pinned,c=[];t.forEach((function(e){n&&e.agentId===le?c.push(e):n||c.push(e)})),a=c,r((function(e){a.forEach((function(a){var t=ha[Math.floor(6*Math.random())];e.findIndex((function(e){return e.chatId===a.chatId}))<0&&(a.profilePic=a.profilePic||t,a.filtered=!0,a.displayName=a.name,e.push(a))})),e.sort((function(e,a){return e.lastMessageAt<a.lastMessageAt?1:-1}))}))},De=function(){var e=Object(d.a)(m.a.mark((function e(a){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.agentId=le,a.chatId=g,e.next=4,f.a.post("".concat(C,"sales/new"),a,y);case 4:t=e.sent,console.log(t),Ce({chatId:t.data.chatId,message:t.data}),M(!1);case 8:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return c.a.createElement("main",{className:_.a.main},c.a.createElement(fa,{file:A,onClose:function(){return M(!1)},handleSendImage:je,handleNewChat:ke,handleChangeSettings:function(e){$(e),localStorage.setItem("settings",JSON.stringify(e)),e.manageUsersLocally||(localStorage.removeItem("salesAgentProfile"),localStorage.removeItem("salesAgentId"))},handleLogin:Ie,handleUpload:function(e){e.persist(),console.log(e.target.files[0]),M({data:e.target.files[0],type:"photoUpload",format:e.target.files[0].type.includes("video")?"video":"photo"}),e.target.value=null},saveSales:De,selectUser:function(e){localStorage.setItem("salesAgentId",e);var a=window.agents[e];localStorage.setItem("salesAgentProfile",JSON.stringify(a)),M(!1)}}),c.a.createElement("div",{className:_.a.container},c.a.createElement(re,{showing:String(ce&&"conversations"===W),data:t,handleSettingsModal:function(){M({type:"settings",settings:Z})},logout:Ae,handleQuery:function(e,a){Te.emit("queryChat",{pinned:a,string:e}),r((function(t){t.map((function(t){var n=e.toLowerCase(),c=!0,r=!0;return e&&(console.log(t.chatId),c=t.displayName&&t.displayName.toLowerCase().includes(n)||t.chatId.slice(0,12).includes(n)),a&&(r=t.agentId===le),t.filtered=c&&r,t}))}))},handleSelectChat:Ee,lowBattery:K,handleNewContactModal:function(){M({type:"newChat",newNumber:te}),ne("")}}),c.a.createElement(ra,{handleBack:function(){return de("conversations")},showing:String(ce&&"chat"===W),handleModal:function(e){M({type:e})},showMedia:function(e,a){M({type:e,id:a})},handleSend:Ne,handleChangeName:be,handleLoadMore:Oe,chat:q||t[S],handlePin:Me})))},wa=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ca(e,a){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),window.location.reload(),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(ba,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var a="".concat("","/service-worker.js");wa?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ca(e,a)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(a,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Ca(a,e)}))}}()},21:function(e,a,t){e.exports={chat:"ChatBox_chat__34TQL",scroll:"ChatBox_scroll__2scZ8",container:"ChatBox_container__3sVfA",input:"ChatBox_input__38Djo",loadMore:"ChatBox_loadMore__B8DE2",linearActivity:"ChatBox_linearActivity__23EWW",indeterminate:"ChatBox_indeterminate__2Mcdq",indeterminate_first:"ChatBox_indeterminate_first__1rI0J",indeterminate_second:"ChatBox_indeterminate_second__3zO2b",emojiContainer:"ChatBox_emojiContainer__1493Q",true:"ChatBox_true__1drss",hide:"ChatBox_hide__3VJj2"}},22:function(e,a,t){e.exports={chatContainer:"Chat_chatContainer__29fRv",centerContainer:"Chat_centerContainer__1LA92",noChat:"Chat_noChat___DfYh",header:"Chat_header__2dzwL",profilePic:"Chat_profilePic__2p-2l",name:"Chat_name__17zfT",pinContainer:"Chat_pinContainer__2II5G",active:"Chat_active__2ZvGz",arrow:"Chat_arrow__qAVEu",nameInput:"Chat_nameInput__Njdoa"}},23:function(e,a,t){e.exports={container:"ContactDetails_container__1YRuT",true:"ContactDetails_true__2fw43",close:"ContactDetails_close__xIkNr",profilePic:"ContactDetails_profilePic__2pL1H",dataContainer:"ContactDetails_dataContainer__2DRX-",nameInput:"ContactDetails_nameInput__ATxfT",hintBubble:"ContactDetails_hintBubble__2V9sb",salesAgent:"ContactDetails_salesAgent__1gra5"}},26:function(e,a,t){e.exports=t.p+"static/media/loading.a8a6c239.gif"},4:function(e,a,t){e.exports={modalBackground:"modal_modalBackground__2bcES",modal:"modal_modal__2sHWD",opaque:"modal_opaque__Y1FSs",button:"modal_button__YYNXp",close:"modal_close__2_ut9",logo:"modal_logo__EhvJ6",qr:"modal_qr__1dgA0",saleType:"modal_saleType__K5u6e"}},48:function(e,a,t){e.exports={main:"App_main__3ZkGI",container:"App_container__1MQN3"}},51:function(e,a,t){e.exports={container:"Spinner_container__ZXxv9",loader:"Spinner_loader__2t1M8"}},6:function(e,a,t){e.exports={container:"Bubble_container__3zp6Q",left:"Bubble_left__2T7Ej",right:"Bubble_right__3dgP0",center:"Bubble_center__3iFQQ",time:"Bubble_time__3nKUc",sale:"Bubble_sale__FweD3",message:"Bubble_message__hkENb",buffer:"Bubble_buffer__2LMrl",day:"Bubble_day__1fmhW",image:"Bubble_image__2IoNd",sticker:"Bubble_sticker__UpjsJ",noBg:"Bubble_noBg__396Lo",audio:"Bubble_audio__Mur7g",audioController:"Bubble_audioController__1JJCY",paused:"Bubble_paused__1bGIe",msg:"Bubble_msg__2OJd2"}},85:function(e,a,t){e.exports=t.p+"static/media/call.b99d263b.svg"},86:function(e,a,t){e.exports=t.p+"static/media/share.d34411d2.svg"},87:function(e,a){e.exports="data:image/png;base64,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"},88:function(e,a,t){e.exports=t.p+"static/media/changeUser.1b5e264a.svg"},89:function(e,a,t){e.exports=t.p+"static/media/gear.55916372.svg"},90:function(e,a,t){e.exports=t.p+"static/media/notification.84551526.ogg"},91:function(e,a,t){e.exports=t.p+"static/media/red.85db7c61.svg"},92:function(e,a,t){e.exports=t.p+"static/media/green.4d30aa8d.svg"},93:function(e,a,t){e.exports=t.p+"static/media/yellow.56cd449d.svg"},94:function(e,a,t){e.exports=t.p+"static/media/blue.28c2945e.svg"},95:function(e,a,t){e.exports=t.p+"static/media/orange.19fe89e2.svg"},96:function(e,a,t){e.exports=t.p+"static/media/purple.115cc2cb.svg"},97:function(e,a,t){e.exports=t.p+"static/media/back.314283b0.svg"},98:function(e,a,t){e.exports=t.p+"static/media/send.b0b5778d.svg"},99:function(e,a,t){e.exports=t.p+"static/media/emoji.872f3332.svg"}},[[111,1,2]]]);
//# sourceMappingURL=main.14e383a9.chunk.js.map